<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Office Login</title>
  <link rel="stylesheet" href="style.css">

  
</head>
<body>
  <div class="login-container">
    <h2>Office Login</h2>
    <form id="loginForm">
  <input type="text" id="username" placeholder="Username" required />
  <input type="password" id="password" placeholder="Password" required />
  <button type="submit">Login</button>
</form>
<div id="message"></div>
  </div>

  <script >
    let firstLocationError = true; // flag to show red only first time

document.getElementById("loginForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const username = document.getElementById("username").value;
  const password = document.getElementById("password").value;
  const message = document.getElementById("message");

  const validUser = "admin";
  const validPass = "1234";

  // Check login credentials
  if (username !== validUser || password !== validPass) {
    message.style.color = "red";
    message.textContent = "Invalid username or password.";
    return;
  }

  // Check geolocation
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        const { latitude, longitude } = pos.coords;

        const officeLat = 11.025057;   
        const officeLng = 77.017449;
        const allowedRadius = 0.1; // km

        if (isWithinRange(latitude, longitude, officeLat, officeLng, allowedRadius)) {
          message.style.color = "green";
          message.textContent = "Login successful! You are inside office location.";
        } else {
          if (firstLocationError) {
            message.style.color = "red";
            message.textContent = "You are not inside the office location.";
            firstLocationError = false; // only first time red
          } else {
            message.style.color = "green";
            message.textContent = "Login successful! (Outside office)";
          }
        }
      },
      (err) => {
        message.style.color = "red";
        message.textContent = "Unable to get your location. Please allow location access.";
      },
      { enableHighAccuracy: true }
    );
  } else {
    message.style.color = "red";
    message.textContent = "Geolocation not supported by your browser.";
  }
});

// Haversine formula to check distance
function isWithinRange(lat1, lon1, lat2, lon2, kmRange) {
  const R = 6371; // Earth radius in km
  const dLat = (lat2 - lat1) * Math.PI / 180;
  const dLon = (lon2 - lon1) * Math.PI / 180;
  const a =
    Math.sin(dLat/2) * Math.sin(dLat/2) +
    Math.cos(lat1 * Math.PI / 180) *
    Math.cos(lat2 * Math.PI / 180) *
    Math.sin(dLon/2) * Math.sin(dLon/2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  const distance = R * c; 
  return distance <= kmRange;
}
  </script>
</body>
</html>